<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>專案文件控管平臺系統稽核工作說明</title>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <style>
        :root {
            --primary-color: #0d5bb5;
            --secondary-color: #1e7e34;
            --accent-color: #c0392b;
            --warning-color: #d68910;
            --light-bg: #f0f2f5;
            --dark-text: #111418;
            --card-shadow: 0 6px 16px rgba(0, 0, 0, 0.15);
            --transition: all 0.3s ease;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft JhengHei', Arial, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #e8edf5 0%, #d5dce7 100%);
            color: var(--dark-text);
            min-height: 100vh;
            padding: 25px;
            line-height: 1.7;
            font-size: 18px;
        }
        
        .container {
            max-width: 1500px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.98);
            border-radius: 20px;
            box-shadow: var(--card-shadow);
            overflow: hidden;
            animation: fadeIn 1s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 25px 40px;
            background: white;
            border-bottom: 2px solid #d0d0d0;
        }
        
        .logo-container {
            display: flex;
            align-items: center;
        }
        
        .logo {
            height: 80px;
            margin-right: 20px;
        }
        
        .title {
            font-size: 32px;
            font-weight: 800;
            color: var(--dark-text);
            text-shadow: 0 3px 6px rgba(0, 0, 0, 0.1);
            letter-spacing: 0.5px;
        }
        
        .tabs {
            display: flex;
            background: white;
            border-bottom: 2px solid #d0d0d0;
        }
        
        .tab {
            flex: 1;
            padding: 20px 0;
            text-align: center;
            font-size: 22px;
            font-weight: 700;
            cursor: pointer;
            transition: var(--transition);
            border-bottom: 4px solid transparent;
            position: relative;
            overflow: hidden;
            background-color: #f8f9fa;
        }
        
        .tab:hover {
            background: #e9ecef;
        }
        
        .tab.active {
            border-bottom: 4px solid var(--primary-color);
            color: var(--primary-color);
            background: white;
            font-weight: 800;
        }
        
        .tab-content {
            display: none;
            padding: 40px;
            min-height: 600px;
            animation: slideIn 0.5s ease;
        }
        
        @keyframes slideIn {
            from { opacity: 0; transform: translateX(20px); }
            to { opacity: 1; transform: translateX(0); }
        }
        
        .tab-content.active {
            display: block;
        }
        
        h2 {
            font-size: 36px;
            font-weight: 800;
            margin-bottom: 30px;
            color: var(--dark-text);
            border-left: 8px solid var(--primary-color);
            padding-left: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #eee;
        }
        
        h3 {
            font-size: 28px;
            font-weight: 700;
            margin: 30px 0 20px;
            color: var(--dark-text);
            padding-left: 10px;
            border-left: 5px solid var(--secondary-color);
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 30px 0;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            border-radius: 12px;
            overflow: hidden;
            border: 2px solid #d0d0d0;
        }
        
        th, td {
            padding: 22px 25px;
            text-align: left;
            border-bottom: 2px solid #d0d0d0;
            font-size: 19px;
        }
        
        th {
            background: var(--primary-color);
            color: white;
            font-weight: 700;
            font-size: 22px;
            text-align: center;
        }
        
        td {
            font-size: 20px;
            font-weight: 600;
            line-height: 1.8;
        }
        
        tr:nth-child(even) {
            background: #f8f9fa;
        }
        
        tr:hover {
            background: #e3f2fd;
            transition: var(--transition);
            transform: scale(1.005);
        }
        
        .wbs-table th:first-child,
        .wbs-table td:first-child {
            width: 10%;
            text-align: center;
            font-weight: 800;
        }
        
        .wbs-table th:nth-child(2),
        .wbs-table td:nth-child(2) {
            width: 35%;
            font-weight: 700;
        }
        
        .wbs-table th:nth-child(3),
        .wbs-table td:nth-child(3) {
            width: 55%;
        }
        
        .raci-table th:first-child,
        .raci-table td:first-child {
            width: 25%;
            font-weight: 700;
        }
        
        .raci-table th:not(:first-child),
        .raci-table td:not(:first-child) {
            width: 18.75%;
            text-align: center;
        }
        
        /* 甘特圖樣式 */
        .gantt-container {
            width: 100%;
            border-collapse: collapse;
            margin-top: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
            background: white;
            overflow: hidden;
            font-size: 18px;
            border: 2px solid #d0d0d0;
        }
        
        .gantt-header {
            background-color: #e9ecef;
        }
        
        .gantt-header th {
            padding: 15px 10px;
            text-align: center;
            border: 2px solid #b0b0b0;
            font-weight: 600;
            min-width: 120px;
            font-size: 20px;
            background-color: #495057;
            color: white;
        }
        
        .week-header {
            background-color: #6c757d;
            font-weight: 700;
            font-size: 22px;
        }
        
        .gantt-body td {
            padding: 12px 10px;
            border: 2px solid #b0b0b0;
            vertical-align: middle;
            min-width: 120px;
            font-size: 19px;
            height: 60px;
        }
        
        .task-name {
            font-weight: 700;
            white-space: nowrap;
            min-width: 300px;
            font-size: 20px;
            padding-left: 15px;
            background-color: #f8f9fa;
        }
        
        .main-task {
            background-color: #f1f3f5;
            font-weight: 800;
            font-size: 22px;
            color: #111418;
        }
        
        .sub-task {
            padding-left: 40px !important;
            font-weight: 600;
            font-size: 19px;
        }
        
        .gantt-bar {
            height: 35px;
            border-radius: 6px;
            position: relative;
            cursor: pointer;
            transition: var(--transition);
            margin: 0 auto;
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.2);
            border: 2px solid rgba(255, 255, 255, 0.3);
        }
        
        .gantt-bar:hover {
            transform: scale(1.08);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        .phase-1 { background-color: #2980b9; }
        .phase-2 { background-color: #27ae60; }
        .phase-3 { background-color: #c0392b; }
        .phase-4 { background-color: #f39c12; }
        
        .tooltip {
            position: absolute;
            background-color: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 12px 18px;
            border-radius: 8px;
            font-size: 18px;
            white-space: nowrap;
            z-index: 100;
            display: none;
            pointer-events: none;
            font-weight: 600;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }
        
        .legend {
            display: flex;
            justify-content: center;
            margin-top: 30px;
            flex-wrap: wrap;
            gap: 25px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 12px;
            border: 2px solid #d0d0d0;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            font-size: 22px;
            font-weight: 700;
        }
        
        .legend-color {
            width: 30px;
            height: 30px;
            margin-right: 15px;
            border-radius: 6px;
            border: 2px solid rgba(0, 0, 0, 0.2);
        }
        
        .controls {
            margin-bottom: 25px;
            text-align: center;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 12px;
            border: 2px solid #d0d0d0;
        }
        
        .filter-btn {
            background-color: #e9ecef;
            border: 2px solid #adb5bd;
            padding: 15px 25px;
            margin: 0 10px;
            cursor: pointer;
            border-radius: 8px;
            transition: var(--transition);
            font-weight: 700;
            font-size: 20px;
            color: #495057;
        }
        
        .filter-btn:hover {
            background-color: #dee2e6;
            transform: translateY(-3px);
        }
        
        .filter-btn.active {
            background-color: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
            font-weight: 800;
            box-shadow: 0 4px 8px rgba(13, 91, 181, 0.3);
        }
        
        .download-btn {
            background-color: var(--secondary-color);
            color: white;
            border: none;
            padding: 18px 35px;
            margin: 20px auto;
            cursor: pointer;
            border-radius: 10px;
            font-size: 22px;
            display: block;
            margin-left: auto;
            margin-right: auto;
            transition: var(--transition);
            font-weight: 800;
            box-shadow: 0 5px 15px rgba(30, 126, 52, 0.3);
            letter-spacing: 1px;
        }
        
        .download-btn:hover {
            background-color: #1a6c2d;
            transform: translateY(-4px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
        }
        
        .download-btn:disabled {
            background-color: #868e96;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        footer {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 25px 40px;
            background: white;
            border-top: 2px solid #d0d0d0;
            margin-top: 40px;
        }
        
        .ste-name {
            height: 60px;
            margin-left: 20px;
        }
        
        footer span {
            font-size: 24px;
            font-weight: 700;
            color: #495057;
        }
        
        /* RACI 角色標記樣式 */
        .raci-role {
            display: inline-block;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            text-align: center;
            line-height: 36px;
            font-weight: 800;
            color: white;
            font-size: 20px;
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.2);
            border: 2px solid white;
        }
        
        .raci-R { background-color: #2980b9; }
        .raci-A { background-color: #27ae60; }
        .raci-C { background-color: #f39c12; }
        .raci-I { background-color: #7f8c8d; }
        
        /* 響應式設計 */
        @media (max-width: 1200px) {
            .container {
                max-width: 95%;
            }
            
            .gantt-container {
                font-size: 16px;
            }
            
            .gantt-header th,
            .gantt-body td {
                min-width: 100px;
            }
            
            .task-name {
                min-width: 250px;
            }
        }
        
        @media (max-width: 768px) {
            body {
                padding: 15px;
                font-size: 16px;
            }
            
            header {
                flex-direction: column;
                text-align: center;
                padding: 20px;
            }
            
            .logo-container {
                margin-bottom: 15px;
            }
            
            .logo {
                height: 70px;
            }
            
            .title {
                font-size: 26px;
            }
            
            .tabs {
                flex-direction: column;
            }
            
            .tab {
                padding: 18px;
                font-size: 20px;
            }
            
            .tab-content {
                padding: 25px;
            }
            
            h2 {
                font-size: 28px;
                padding-left: 15px;
            }
            
            h3 {
                font-size: 24px;
            }
            
            th, td {
                padding: 18px 20px;
                font-size: 18px;
            }
            
            .controls {
                display: flex;
                flex-wrap: wrap;
                justify-content: center;
            }
            
            .filter-btn {
                margin: 8px;
                flex: 1;
                min-width: 160px;
                font-size: 18px;
                padding: 12px 20px;
            }
            
            .gantt-container {
                font-size: 14px;
                overflow-x: auto;
                display: block;
            }
            
            .gantt-header th {
                padding: 12px 8px;
                min-width: 90px;
                font-size: 16px;
            }
            
            .gantt-body td {
                padding: 10px 8px;
                min-width: 90px;
                font-size: 15px;
            }
            
            .task-name {
                min-width: 200px;
                font-size: 16px;
            }
            
            .legend-item {
                font-size: 18px;
            }
            
            footer span {
                font-size: 20px;
            }
            
            .download-btn {
                font-size: 20px;
                padding: 15px 25px;
            }
        }
        
        @media (max-width: 480px) {
            body {
                padding: 10px;
            }
            
            .container {
                border-radius: 15px;
            }
            
            .tab-content {
                padding: 20px;
            }
            
            .legend {
                flex-direction: column;
                align-items: center;
                gap: 15px;
            }
            
            .gantt-container {
                font-size: 12px;
            }
            
            .title {
                font-size: 22px;
            }
            
            h2 {
                font-size: 24px;
            }
        }
        
        /* 進度指示器 */
        .progress-indicator {
            height: 8px;
            background-color: #dee2e6;
            position: relative;
            margin-bottom: 30px;
            border-radius: 4px;
        }
        
        .progress-bar {
            height: 100%;
            background-color: var(--primary-color);
            border-radius: 4px;
            transition: width 0.5s ease;
            box-shadow: 0 2px 8px rgba(13, 91, 181, 0.3);
        }
        
        /* 列印樣式 */
        @media print {
            body {
                background: white;
                padding: 0;
                font-size: 16px;
            }
            
            .container {
                box-shadow: none;
                border-radius: 0;
            }
            
            .tab-content {
                display: block !important;
                page-break-inside: avoid;
                padding: 20px;
            }
            
            .tab {
                display: none;
            }
            
            .download-btn, .filter-btn {
                display: none;
            }
            
            h2 {
                font-size: 24px;
            }
            
            th, td {
                padding: 15px 18px;
                font-size: 16px;
            }
        }
        
        /* 額外的易讀性增強 */
        p, ul, li {
            font-size: 22px;
            font-weight: 600;
            line-height: 1.8;
            color: #2c3e50;
            margin-bottom: 15px;
        }
        
        ul {
            padding-left: 40px;
        }
        
        li {
            margin-bottom: 12px;
        }
        
        strong {
            font-weight: 800;
            color: #111418;
        }
        
        /* 高對比度增強 */
        .high-contrast {
            background-color: white;
            color: #111418;
            border-color: #111418;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo-container">
                <img src="https://i.urusai.cc/Qlsat.png" alt="STE LOGO" class="logo">
                <h1 class="title">專案文件控管平臺系統稽核工作說明</h1>
            </div>
        </header>
        
        <div class="progress-indicator">
            <div class="progress-bar" id="progressBar" style="width: 33%"></div>
        </div>
        
        <div class="tabs">
            <div class="tab active" data-tab="tab1">專案稽核工作分解結構 (WBS)</div>
            <div class="tab" data-tab="tab2">RACI 職責劃分表</div>
            <div class="tab" data-tab="tab3">稽核時程甘特圖</div>
        </div>
        
        <div class="tab-content active" id="tab1">
            <h2>專案稽核工作分解結構 (WBS)</h2>
            
            <table class="wbs-table">
                <thead>
                    <tr>
                        <th>WBS</th>
                        <th>WBS 工作項目 (Work Breakdown Structure)</th>
                        <th>階段目標與說明</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>1.0</strong></td>
                        <td><strong>稽核啟動與規劃階段 (Initiation & Planning)</strong></td>
                        <td>確立稽核範圍，並確保資源到位。</td>
                    </tr>
                    <tr>
                        <td>1.1</td>
                        <td>稽核啟動與目標確立</td>
                        <td>召開啟動會議，定義稽核範圍（RK, RL, YM, TYGL, ME06A）及時程。</td>
                    </tr>
                    <tr>
                        <td><strong>2.0</strong></td>
                        <td><strong>合約合規性與文件證據查核 (Contract Compliance & Evidence)</strong></td>
                        <td>核心任務：查核所有合約權利主張、款項追蹤及證據累積是否到位且符合規定。</td>
                    </tr>
                    <tr>
                        <td>2.1</td>
                        <td>專案每月正式發函有效性稽核 (RK、RL、YM、TYGL、ME06A）</td>
                        <td>查核專案經理是否<strong>每月發函給業主</strong>，且函中附有<strong>圖說、照片和日期標註</strong>等實質證據。</td>
                    </tr>
                    <tr>
                        <td>2.2</td>
                        <td>CBS 變更依據及合規性驗證</td>
                        <td>查核所有 CBS 變更是否皆具備<strong>業主正式認可檔</strong>。</td>
                    </tr>
                    <tr>
                        <td>2.3</td>
                        <td>分包商同意書回溯查核</td>
                        <td>查核高雄三專案在 CBS 進版時，是否已取得<strong>所有專業分包商的同意書或發文告知記錄</strong>。</td>
                    </tr>
                    <tr>
                        <td><strong>3.0</strong></td>
                        <td><strong>文件控管平臺系統稽核 (Cost Control & Platform Audit)</strong></td>
                        <td>驗證總經理要求建立的證據平臺和延期成本收集工作的完成度，以作為未來向業主<strong>追加費用</strong>的依據。</td>
                    </tr>
                    <tr>
                        <td>3.1</td>
                        <td>文件控管平臺建立狀態查核</td>
                        <td>驗證專案是否已建立<strong>統一的NAS文件控管平臺及檔案夾</strong>，用於控管所有收發文記錄。</td>
                    </tr>
                    <tr>
                        <td>3.2</td>
                        <td>展延成本憑據收集狀態查核</td>
                        <td>查核已展延專案是否已收集所有相關費用（如<strong>人力資源成本、延期保固</strong>）的憑據。</td>
                    </tr>
                    <tr>
                        <td><strong>4.0</strong></td>
                        <td><strong>稽核報告與決策 (Reporting & Finalization)</strong></td>
                        <td>總結發現、提出建議並獲得總經理室批准。</td>
                    </tr>
                    <tr>
                        <td>4.1</td>
                        <td>擬定稽核發現與建議報告（初稿）</td>
                        <td>根據查核結果，彙總不合規事項及風險評估。</td>
                    </tr>
                    <tr>
                        <td>4.2</td>
                        <td>報告審核與核准</td>
                        <td>提交報告給合約法務經理（LM）及總經理室進行審核與最終決策。</td>
                    </tr>
                </tbody>
            </table>
        </div>
        
        <div class="tab-content" id="tab2">
            <h2>RACI 職責劃分表 (Stakeholders)</h2>
            
            <table class="raci-table">
                <thead>
                    <tr>
                        <th>WBS 編號/任務名稱</th>
                        <th>1.專案每月發函<br>有效性稽核</th>
                        <th>2.分包商同意書查核</th>
                        <th>3.展延成本<br>憑據查核</th>
                        <th>4.報告審核<br>與核准</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>工程處專案經理 (PM)</strong></td>
                        <td><span class="raci-role raci-A">A</span> (提供證據)</td>
                        <td><span class="raci-role raci-C">C</span></td>
                        <td><span class="raci-role raci-R">R</span> (提供憑據)</td>
                        <td><span class="raci-role raci-I">I</span></td>
                    </tr>
                    <tr>
                        <td><strong>合約法務經理 (LM)</strong></td>
                        <td><span class="raci-role raci-A">A</span> (專案合規當責)</td>
                        <td><span class="raci-role raci-R">R</span> (查核合規性)</td>
                        <td><span class="raci-role raci-C">C</span></td>
                        <td><span class="raci-role raci-C">C</span></td>
                    </tr>
                    <tr>
                        <td><strong>QAD (稽核執行/監控)</strong></td>
                        <td><span class="raci-role raci-R">R</span> (執行抽樣)</td>
                        <td><span class="raci-role raci-R">R</span> (執行抽樣)</td>
                        <td><span class="raci-role raci-R">R</span> (執行抽樣)</td>
                        <td><span class="raci-role raci-A">A</span> (報告匯總)</td>
                    </tr>
                    <tr>
                        <td><strong>總經理室 (GMO)</strong></td>
                        <td><span class="raci-role raci-I">I</span></td>
                        <td><span class="raci-role raci-I">I</span></td>
                        <td><span class="raci-role raci-I">I</span></td>
                        <td><span class="raci-role raci-A">A</span> (最終決策)</td>
                    </tr>
                </tbody>
            </table>
            
            <h3>說明:</h3>
            <p><strong>RACI 職責劃分表</strong></p>
            <p>本表針對稽核過程中的關鍵任務，劃分利害關係人的職責：</p>
            <ul>
                <li><span class="raci-role raci-R">R</span> <strong>(Responsible, 負責執行者)</strong>: 實際執行工作的人。</li>
                <li><span class="raci-role raci-A">A</span> <strong>(Accountable, 負責/當責者)</strong>: 對任務結果負最終責任的人（通常只有一位）。</li>
                <li><span class="raci-role raci-C">C</span> <strong>(Consulted, 諮詢者)</strong>: 在執行前必須提供意見或資訊的人。</li>
                <li><span class="raci-role raci-I">I</span> <strong>(Informed, 告知者)</strong>: 需被告知進度或結果的人。</li>
            </ul>
        </div>
        
        <div class="tab-content" id="tab3">
            <h2>稽核時程甘特圖 (Gantt Chart)</h2>
            <p><strong>稽核期：2025年12月1日 ~ 2026年1月31日 (共9週)</strong></p>
            
            <div class="controls">
                <button class="filter-btn active" data-filter="all">顯示全部</button>
                <button class="filter-btn" data-filter="1">啟動與規劃階段</button>
                <button class="filter-btn" data-filter="2">合約合規性與證據查核</button>
                <button class="filter-btn" data-filter="3">文件控管平臺系統稽核</button>
                <button class="filter-btn" data-filter="4">稽核報告與決策</button>
            </div>
            
            <button id="downloadBtn" class="download-btn">下載甘特圖為PNG</button>
            
            <div id="gantt-chart">
                <table class="gantt-container">
                    <thead class="gantt-header">
                        <tr>
                            <th rowspan="2">主要階段名稱</th>
                            <th colspan="9" class="week-header">週次 (共9週)</th>
                        </tr>
                        <tr>
                            <th>第 1 週<br>(Dec 1-7)</th>
                            <th>第 2 週<br>(Dec 8-14)</th>
                            <th>第 3 週<br>(Dec 15-21)</th>
                            <th>第 4 週<br>(Dec 22-28)</th>
                            <th>第 5 週<br>(Dec 29-Jan 4)</th>
                            <th>第 6 週<br>(Jan 5-11)</th>
                            <th>第 7 週<br>(Jan 12-18)</th>
                            <th>第 8 週<br>(Jan 19-25)</th>
                            <th>第 9 週<br>(Jan 26-31)</th>
                        </tr>
                    </thead>
                    <tbody class="gantt-body">
                        <!-- 啟動與規劃階段 -->
                        <tr class="phase-1-row">
                            <td class="task-name main-task">1.0 啟動與規劃階段</td>
                            <td><div class="gantt-bar phase-1" style="width: 100%;" data-task="1.0 啟動與規劃階段" data-week="第1週"></div></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr class="phase-1-row">
                            <td class="task-name sub-task">1.1 確立稽核範圍與啟動會議</td>
                            <td><div class="gantt-bar phase-1" style="width: 100%;" data-task="1.1 確立稽核範圍與啟動會議" data-week="第1週"></div></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        
                        <!-- 合約合規性與證據查核 -->
                        <tr class="phase-2-row">
                            <td class="task-name main-task">2.0 合約合規性與證據查核</td>
                            <td><div class="gantt-bar phase-2" style="width: 50%;" data-task="2.0 合約合規性與證據查核" data-week="第1週"></div></td>
                            <td><div class="gantt-bar phase-2" style="width: 100%;" data-task="2.0 合約合規性與證據查核" data-week="第2週"></div></td>
                            <td><div class="gantt-bar phase-2" style="width: 100%;" data-task="2.0 合約合規性與證據查核" data-week="第3週"></div></td>
                            <td><div class="gantt-bar phase-2" style="width: 100%;" data-task="2.0 合約合規性與證據查核" data-week="第4週"></div></td>
                            <td><div class="gantt-bar phase-2" style="width: 100%;" data-task="2.0 合約合規性與證據查核" data-week="第5週"></div></td>
                            <td><div class="gantt-bar phase-2" style="width: 50%;" data-task="2.0 合約合規性與證據查核" data-week="第6週"></div></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr class="phase-2-row">
                            <td class="task-name sub-task">2.1 專案每月正式發函有效性稽核</td>
                            <td><div class="gantt-bar phase-2" style="width: 50%;" data-task="2.1 專案每月正式發函有效性稽核" data-week="第1週"></div></td>
                            <td><div class="gantt-bar phase-2" style="width: 100%;" data-task="2.1 專案每月正式發函有效性稽核" data-week="第2週"></div></td>
                            <td><div class="gantt-bar phase-2" style="width: 100%;" data-task="2.1 專案每月正式發函有效性稽核" data-week="第3週"></div></td>
                            <td><div class="gantt-bar phase-2" style="width: 100%;" data-task="2.1 專案每月正式發函有效性稽核" data-week="第4週"></div></td>
                            <td><div class="gantt-bar phase-2" style="width: 100%;" data-task="2.1 專案每月正式發函有效性稽核" data-week="第5週"></div></td>
                            <td><div class="gantt-bar phase-2" style="width: 50%;" data-task="2.1 專案每月正式發函有效性稽核" data-week="第6週"></div></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr class="phase-2-row">
                            <td class="task-name sub-task">2.2 CBS 變更依據及合規性驗證</td>
                            <td></td>
                            <td><div class="gantt-bar phase-2" style="width: 100%;" data-task="2.2 CBS 變更依據及合規性驗證" data-week="第2週"></div></td>
                            <td><div class="gantt-bar phase-2" style="width: 100%;" data-task="2.2 CBS 變更依據及合規性驗證" data-week="第3週"></div></td>
                            <td><div class="gantt-bar phase-2" style="width: 100%;" data-task="2.2 CBS 變更依據及合規性驗證" data-week="第4週"></div></td>
                            <td><div class="gantt-bar phase-2" style="width: 100%;" data-task="2.2 CBS 變更依據及合規性驗證" data-week="第5週"></div></td>
                            <td><div class="gantt-bar phase-2" style="width: 50%;" data-task="2.2 CBS 變更依據及合規性驗證" data-week="第6週"></div></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr class="phase-2-row">
                            <td class="task-name sub-task">2.3 分包商同意書回溯查核 (RK/RL/YM)</td>
                            <td></td>
                            <td><div class="gantt-bar phase-2" style="width: 100%;" data-task="2.3 分包商同意書回溯查核" data-week="第2週"></div></td>
                            <td><div class="gantt-bar phase-2" style="width: 100%;" data-task="2.3 分包商同意書回溯查核" data-week="第3週"></div></td>
                            <td><div class="gantt-bar phase-2" style="width: 100%;" data-task="2.3 分包商同意書回溯查核" data-week="第4週"></div></td>
                            <td><div class="gantt-bar phase-2" style="width: 100%;" data-task="2.3 分包商同意書回溯查核" data-week="第5週"></div></td>
                            <td><div class="gantt-bar phase-2" style="width: 50%;" data-task="2.3 分包商同意書回溯查核" data-week="第6週"></div></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        
                        <!-- 文件控管平臺系統稽核 -->
                        <tr class="phase-3-row">
                            <td class="task-name main-task">3.0 文件控管平臺系統稽核</td>
                            <td></td>
                            <td></td>
                            <td><div class="gantt-bar phase-3" style="width: 50%;" data-task="3.0 文件控管平臺系統稽核" data-week="第3週"></div></td>
                            <td><div class="gantt-bar phase-3" style="width: 100%;" data-task="3.0 文件控管平臺系統稽核" data-week="第4週"></div></td>
                            <td><div class="gantt-bar phase-3" style="width: 100%;" data-task="3.0 文件控管平臺系統稽核" data-week="第5週"></div></td>
                            <td><div class="gantt-bar phase-3" style="width: 100%;" data-task="3.0 文件控管平臺系統稽核" data-week="第6週"></div></td>
                            <td><div class="gantt-bar phase-3" style="width: 100%;" data-task="3.0 文件控管平臺系統稽核" data-week="第7週"></div></td>
                            <td><div class="gantt-bar phase-3" style="width: 100%;" data-task="3.0 文件控管平臺系統稽核" data-week="第8週"></div></td>
                            <td><div class="gantt-bar phase-3" style="width: 50%;" data-task="3.0 文件控管平臺系統稽核" data-week="第9週"></div></td>
                        </tr>
                        <tr class="phase-3-row">
                            <td class="task-name sub-task">3.1 文件控管平臺建立狀態查核</td>
                            <td></td>
                            <td></td>
                            <td><div class="gantt-bar phase-3" style="width: 50%;" data-task="3.1 文件控管平臺建立狀態查核" data-week="第3週"></div></td>
                            <td><div class="gantt-bar phase-3" style="width: 100%;" data-task="3.1 文件控管平臺建立狀態查核" data-week="第4週"></div></td>
                            <td><div class="gantt-bar phase-3" style="width: 100%;" data-task="3.1 文件控管平臺建立狀態查核" data-week="第5週"></div></td>
                            <td><div class="gantt-bar phase-3" style="width: 100%;" data-task="3.1 文件控管平臺建立狀態查核" data-week="第6週"></div></td>
                            <td><div class="gantt-bar phase-3" style="width: 50%;" data-task="3.1 文件控管平臺建立狀態查核" data-week="第7週"></div></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr class="phase-3-row">
                            <td class="task-name sub-task">3.2 展延成本憑據收集狀態查核</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td><div class="gantt-bar phase-3" style="width: 50%;" data-task="3.2 展延成本憑據收集狀態查核" data-week="第4週"></div></td>
                            <td><div class="gantt-bar phase-3" style="width: 100%;" data-task="3.2 展延成本憑據收集狀態查核" data-week="第5週"></div></td>
                            <td><div class="gantt-bar phase-3" style="width: 100%;" data-task="3.2 展延成本憑據收集狀態查核" data-week="第6週"></div></td>
                            <td><div class="gantt-bar phase-3" style="width: 100%;" data-task="3.2 展延成本憑據收集狀態查核" data-week="第7週"></div></td>
                            <td><div class="gantt-bar phase-3" style="width: 100%;" data-task="3.2 展延成本憑據收集狀態查核" data-week="第8週"></div></td>
                            <td><div class="gantt-bar phase-3" style="width: 50%;" data-task="3.2 展延成本憑據收集狀態查核" data-week="第9週"></div></td>
                        </tr>
                        
                        <!-- 稽核報告與決策 -->
                        <tr class="phase-4-row">
                            <td class="task-name main-task">4.0 稽核報告與決策</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td><div class="gantt-bar phase-4" style="width: 50%;" data-task="4.0 稽核報告與決策" data-week="第6週"></div></td>
                            <td><div class="gantt-bar phase-4" style="width: 100%;" data-task="4.0 稽核報告與決策" data-week="第7週"></div></td>
                            <td><div class="gantt-bar phase-4" style="width: 100%;" data-task="4.0 稽核報告與決策" data-week="第8週"></div></td>
                            <td><div class="gantt-bar phase-4" style="width: 100%;" data-task="4.0 稽核報告與決策" data-week="第9週"></div></td>
                        </tr>
                        <tr class="phase-4-row">
                            <td class="task-name sub-task">4.1 擬定稽核發現與建議報告（初稿）</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td><div class="gantt-bar phase-4" style="width: 50%;" data-task="4.1 擬定稽核發現與建議報告（初稿）" data-week="第6週"></div></td>
                            <td><div class="gantt-bar phase-4" style="width: 100%;" data-task="4.1 擬定稽核發現與建議報告（初稿）" data-week="第7週"></div></td>
                            <td><div class="gantt-bar phase-4" style="width: 50%;" data-task="4.1 擬定稽核發現與建議報告（初稿）" data-week="第8週"></div></td>
                            <td></td>
                        </tr>
                        <tr class="phase-4-row">
                            <td class="task-name sub-task">4.2 報告審核與核准</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td><div class="gantt-bar phase-4" style="width: 50%;" data-task="4.2 報告審核與核准" data-week="第8週"></div></td>
                            <td><div class="gantt-bar phase-4" style="width: 100%;" data-task="4.2 報告審核與核准" data-week="第9週"></div></td>
                        </tr>
                    </tbody>
                </table>
                
                <div class="legend">
                    <div class="legend-item">
                        <div class="legend-color phase-1"></div>
                        <span>啟動與規劃階段</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color phase-2"></div>
                        <span>合約合規性與證據查核</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color phase-3"></div>
                        <span>文件控管平臺系統稽核</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color phase-4"></div>
                        <span>稽核報告與決策</span>
                    </div>
                </div>
            </div>
        </div>
        
        <footer>
            <span>品保部跨部門協作</span>
            <img src="https://i.urusai.cc/GXiu2.png" alt="STE NAME" class="ste-name">
        </footer>
    </div>
    
    <div class="tooltip" id="tooltip"></div>
    
    <script>
        // 分頁切換功能
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', () => {
                // 移除所有active類
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                
                // 添加active類到當前分頁
                tab.classList.add('active');
                document.getElementById(tab.dataset.tab).classList.add('active');
                
                // 更新進度條
                updateProgressBar(tab.dataset.tab);
            });
        });
        
        // 更新進度條
        function updateProgressBar(activeTab) {
            const progressBar = document.getElementById('progressBar');
            let progress = 33;
            
            switch(activeTab) {
                case 'tab1':
                    progress = 33;
                    break;
                case 'tab2':
                    progress = 66;
                    break;
                case 'tab3':
                    progress = 100;
                    break;
            }
            
            progressBar.style.width = `${progress}%`;
        }
        
        // 工具提示功能
        const tooltip = document.getElementById('tooltip');
        const bars = document.querySelectorAll('.gantt-bar');
        
        bars.forEach(bar => {
            bar.addEventListener('mouseover', function(e) {
                const task = this.getAttribute('data-task');
                const week = this.getAttribute('data-week');
                const widthPercent = this.style.width;
                tooltip.textContent = `${task} - ${week} (${widthPercent})`;
                tooltip.style.display = 'block';
                
                // 更新工具提示位置
                const rect = this.getBoundingClientRect();
                tooltip.style.left = (rect.left + window.scrollX) + 'px';
                tooltip.style.top = (rect.top + window.scrollY - 50) + 'px';
            });
            
            bar.addEventListener('mousemove', function(e) {
                tooltip.style.left = (e.pageX + 15) + 'px';
                tooltip.style.top = (e.pageY - 40) + 'px';
            });
            
            bar.addEventListener('mouseout', function() {
                tooltip.style.display = 'none';
            });
        });
        
        // 篩選功能
        const filterButtons = document.querySelectorAll('.filter-btn');
        
        filterButtons.forEach(button => {
            button.addEventListener('click', function() {
                // 移除所有按鈕的active類
                filterButtons.forEach(btn => btn.classList.remove('active'));
                
                // 添加active類到當前按鈕
                this.classList.add('active');
                
                const filter = this.getAttribute('data-filter');
                
                // 顯示或隱藏行
                const rows = document.querySelectorAll('tbody tr');
                rows.forEach(row => {
                    if (filter === 'all') {
                        row.style.display = '';
                    } else {
                        if (row.classList.contains(`phase-${filter}-row`)) {
                            row.style.display = '';
                        } else {
                            row.style.display = 'none';
                        }
                    }
                });
            });
        });
        
        // PNG下載功能
        const downloadBtn = document.getElementById('downloadBtn');
        
        downloadBtn.addEventListener('click', function() {
            // 顯示載入訊息
            downloadBtn.textContent = '正在生成PNG...';
            downloadBtn.disabled = true;
            
            // 使用html2canvas將甘特圖轉換為圖片
            html2canvas(document.getElementById('gantt-chart'), {
                scale: 2, // 提高圖片質量
                useCORS: true,
                logging: false,
                backgroundColor: '#ffffff',
                width: document.getElementById('gantt-chart').scrollWidth,
                height: document.getElementById('gantt-chart').scrollHeight
            }).then(canvas => {
                // 將canvas轉換為圖片URL
                const imgData = canvas.toDataURL('image/png');
                
                // 創建下載連結
                const link = document.createElement('a');
                link.href = imgData;
                link.download = '稽核時程甘特圖_20251201-20260131_大字版.png';
                
                // 觸發下載
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                // 恢復按鈕狀態
                downloadBtn.textContent = '下載甘特圖為PNG';
                downloadBtn.disabled = false;
            }).catch(error => {
                console.error('生成PNG時發生錯誤:', error);
                alert('下載失敗，請重試');
                
                // 恢復按鈕狀態
                downloadBtn.textContent = '下載甘特圖為PNG';
                downloadBtn.disabled = false;
            });
        });
        
        // 增加高對比度切換功能
        const toggleContrast = document.createElement('button');
        toggleContrast.textContent = '高對比度模式';
        toggleContrast.style.cssText = `
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 12px 20px;
            background-color: #111418;
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: 700;
            font-size: 16px;
            cursor: pointer;
            z-index: 1000;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        `;
        
        toggleContrast.addEventListener('click', function() {
            document.body.classList.toggle('high-contrast');
            this.textContent = document.body.classList.contains('high-contrast') 
                ? '恢復正常模式' 
                : '高對比度模式';
        });
        
        document.body.appendChild(toggleContrast);
        
        // 初始化進度條
        updateProgressBar('tab1');
        
        // 增加頁面載入後的字體大小確認
        window.addEventListener('load', function() {
            console.log('大字體版本已載入，適合老人家閱讀');
            console.log('主要字體大小: 標題32px, 內容22px, 表格20px');
        });
    </script>
</body>
</html>
